#!/bin/bash

# This script is designed to install and setup all software on Arch Linux.
########################################
# NOTES
# Install git as an additional package when prompted to quickly clone this repo.
# If using archinstall, select Minimal option when prompted.
# After initial install, reboot and login into user.  Then clone this repo to $HOME/dotfiles and then run $HOME/dotfiles/scripts/install/arch.

# Software
#   i3-gaps                 Window manager
#       dmenu                   Application launcher
#       feh                     Image viewer to set background
#       playerctl               Media player controller
#       betterlockscreen        Lock screen
#       xautolock               Timer to lock after inactivity
#   polybar                 Status bar
#       dbus-python             Display spotify info module
#   picom                   Compositor
#   alacritty               Terminal emulator
#   zsh                     Shell
#       oh-my-zsh               Zsh framework
#           gnu-free-fonts          Font for various symbols
#   neovim                  Text editor
#   tmux                    Terminal multiplexer
#   nvidia                  Graphics driver
#       nvidia-settings         Tool to configure NVIDIA settings
#   git                     Personal config
#   yay                     Pacman wrapper and AUR helper
#       base-devel              Pacakage group for installing AURs
#   curl                    Transfer data

# Personal
#   pulseaudio              Sound server
#   firefox                 Web browser
#   spotify                 Music player
#   discord                 Voice and text chat app

########################################

# dotfiles related packages
########################################
sudo pacman -S xorg xorg-server xorg-xinit i3-gaps dmenu feh playerctl xautolock picom alacritty zsh neovim tmux nvidia nvidia-settings git base-devel curl gnu-free-fonts

# install yay
mkdir $HOME/aur
git clone https://aur.archlinux.org/yay.git $HOME/yay
cd $HOME/yay
makepkg -si
cd -

yay -S polybar betterlockscreen dbus-python

$HOME/dotfiles/scripts/setup
$HOME/dotfiles/scripts/symlink


# personal packages
########################################
sudo pacman -S pulseaudio discord firefox
yay -S spotify


# start
########################################
# load nvidia settings
nvidia-settings --load-config-only

# add 'exec i3' to .xinitrc
cp /etc/X11/xinit/xinitrc $HOME/.xinitrc
echo -e "\nexec i3" >> $HOME/.xinitrc

# apply flat mouse acceleration with xrandr
echo -e "Section \"InputClass\"" >> /etc/X11/xorg.conf.d/50-mouse-acceleration.conf
echo -e "\tIdentifier \"My Mouse\"" >> /etc/X11/xorg.conf.d/50-mouse-acceleration.conf
echo -e "\tDriver \"libinput\"" >> /etc/X11/xorg.conf.d/50-mouse-acceleration.conf
echo -e "\tMatchIsPointer \"yes\"" >> /etc/X11/xorg.conf.d/50-mouse-acceleration.conf
echo -e "\tOption \"AccelProfile\" \"flat\"" >> /etc/X11/xorg.conf.d/50-mouse-acceleration.conf
echo -e "\tOption \"AccelSpeed\" \"0\"" >> /etc/X11/xorg.conf.d/50-mouse-acceleration.conf
echo -e "EndSection" >> /etc/X11/xorg.conf.d/50-mouse-acceleration.conf

startx
